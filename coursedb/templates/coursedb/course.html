{% extends 'coursedb/base.html' %}

{% block content %}
<h1>{{ course.title }}</h1>
<p>{{ department.name }}, {{ school.name }}</p>
<p class="note">{{ course.note }}</p>
<p>{{ course.description }}</p>

<div class="google_maps">
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
</script><div style="overflow:hidden;height:250px;width:600px;">
<div id="gmap_canvas" style="height:250px;width:600px;">
</div><style>#gmap_canvas img{max-width:none!important;background:none!important}</style>
<a class="google-map-code" href="http://premium-wordpress-themes.org" id="get-map-data">premium-wordpress-themes.org</a>
</div><script type="text/javascript">
function init_map()
{var myOptions = {zoom:15,center:new google.maps.LatLng({{location.latitude}},{{location.longitude}}),
mapTypeId: google.maps.MapTypeId.ROADMAP};
map = new google.maps.Map(document.getElementById("gmap_canvas"),
myOptions);
marker = new google.maps.Marker({map: map,position: new google.maps.LatLng({{location.latitude}},{{location.longitude}})});
infowindow = new google.maps.InfoWindow({content:"<b>{{department.school}}</b><br/>{{location.address}}<br/>Boston, MA 02215" });
google.maps.event.addListener(marker, "click", function(){infowindow.open(map,marker);});}
google.maps.event.addDomListener(window, 'load', init_map);
</script>

<script>
function add_course(school, dept, num, sec) {
    var xhttp = new XMLHttpRequest();
    xhttp.open("GET",
        "/db/api/add_course?school=" + school +
        "&department=" + dept +
        "&number=" + num +
        "&section=" + sec
    , true);
    xhttp.send();
}

function clear_course() {
    var xhttp = new XMLHttpRequest();
    xhttp.open("GET", "/db/api/clear_courses", true);
    xhttp.send();
}
</script>

<input
    type="button"
    id="clear"
    onclick="clear_course();"
    value="Clear Courses"
>


{% for course in courses_added %}
{{ course }}<br>
{% endfor %}


<table class="sections">
    <tr>
        <th></th>
        <th>Section</th>
        <th>Type</th>
        <th>Instructor</th>
        <th>Open seats</th>
        <th>Meetings</th>
    </tr>
{% for section in sections %}
    <tr>

        <td>
<input
    type="button"
    id="add"
    onclick="add_course('{{ school.symbol }}', '{{ department.symbol }}', '{{ course.number }}', '{{ section.section }}');"
    value="Add"
>
</td>
        <td>{{ section.section }}</td>
        <td>{{ section.type }}</td>

        {% if section.instructor %}
        <td>{{ section.instructor }}</td>
        {% else %}
        <td>Unknown</td>
        {% endif %}

        {% if section.open_seats %}
        <td>{{ section.open_seats }}</td>
        {% else %}
        <td>Unknown</td>
        {% endif %}

        <td>
            <table class="meetings">
                <tr>
                    <th>Days</th>
                    <th>Time</th>
                    <th>Location</th>
                </tr>
            {% for meeting in section.meetings %}
                <tr>
                    <td>{{ meeting.days_as_string }}</td>
                    <td>{{ meeting.start }}&ndash;{{ meeting.end }}</td>
                    <td>{{ meeting.building.symbol }} {{ meeting.room }}</td>
                </tr>
            {% endfor %}
            </table>
        </td>
    </tr>
{% endfor %}
</table>

{% endblock %}
